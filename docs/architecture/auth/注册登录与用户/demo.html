<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TenderVault Enterprise Admin - V2.0</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'Noto Sans SC', 'sans-serif'] },
                    colors: {
                        primary: '#0F172A', // Slate 900
                        accent: '#2563EB', // Blue 600
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.2s ease-out forwards',
                        'slide-down': 'slideDown 0.2s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideDown: { '0%': { transform: 'translateY(-10px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } }
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', 'Noto Sans SC', sans-serif; background-color: #F8FAFC; color: #1E293B; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
        
        .glass-panel { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px); }
        .nav-item.active { background-color: #1E293B; color: #FFFFFF; border-left: 3px solid #3B82F6; }
        
        /* Modal Transitions */
        .modal { transition: opacity 0.25s ease; }
        .modal-content { transition: transform 0.25s ease; }
        body.modal-open { overflow: hidden; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-sm">

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-5 right-5 z-[100] flex flex-col gap-2"></div>

    <!-- Presentation Bar -->
    <div class="bg-slate-900 text-slate-400 p-2 flex justify-between items-center shadow-lg z-50 shrink-0 border-b border-slate-700">
        <div class="flex items-center gap-2">
            <span class="bg-red-600 text-white px-2 py-0.5 rounded text-[10px] font-bold tracking-wider">SUPER ADMIN</span>
            <span class="text-xs">系统全功能演示 V2.0</span>
        </div>
        <div class="flex gap-2">
            <button onclick="router('dashboard')" class="px-2 py-1 hover:text-white transition"><i class="fa-solid fa-house mr-1"></i>总览</button>
            <button onclick="router('projects')" class="px-2 py-1 hover:text-white transition"><i class="fa-solid fa-box mr-1"></i>项目管理</button>
            <button onclick="router('approval')" class="px-2 py-1 hover:text-white transition"><i class="fa-solid fa-check-double mr-1"></i>审批流</button>
            <button onclick="router('audit')" class="px-2 py-1 hover:text-white transition"><i class="fa-solid fa-chart-line mr-1"></i>审计日志</button>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div class="flex-1 flex overflow-hidden">
        
        <!-- SIDEBAR -->
        <aside class="w-64 bg-slate-900 text-slate-300 flex flex-col shrink-0 border-r border-slate-800">
            <div class="h-16 flex items-center px-6 border-b border-slate-800">
                <div class="text-white font-bold text-lg flex items-center gap-2">
                    <i class="fa-solid fa-layer-group text-blue-500"></i> TenderVault <span class="text-[10px] bg-slate-700 px-1 rounded text-slate-300">ENT</span>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto py-4">
                <div class="px-4 mb-2 text-[10px] font-bold text-slate-500 uppercase">监控台</div>
                <nav class="space-y-1 mb-6">
                    <a onclick="router('dashboard')" id="nav-dashboard" class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition">
                        <i class="fa-solid fa-gauge-high w-5"></i> <span>仪表盘</span>
                    </a>
                    <a onclick="router('audit')" id="nav-audit" class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition">
                        <i class="fa-solid fa-shield-cat w-5"></i> <span>安全审计</span>
                    </a>
                </nav>

                <div class="px-4 mb-2 text-[10px] font-bold text-slate-500 uppercase">业务管理</div>
                <nav class="space-y-1 mb-6">
                    <a onclick="router('projects')" id="nav-projects" class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition">
                        <i class="fa-solid fa-briefcase w-5"></i> <span>项目文档库</span>
                    </a>
                    <a onclick="router('library')" id="nav-library" class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition">
                        <i class="fa-solid fa-database w-5"></i> <span>企业资质库</span>
                    </a>
                    <a onclick="router('approval')" id="nav-approval" class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition justify-between">
                        <div class="flex items-center"><i class="fa-solid fa-file-signature w-5"></i> <span>审批中心</span></div>
                        <span class="bg-red-500 text-white text-[10px] px-1.5 rounded-full font-bold" id="sidebar-badge">4</span>
                    </a>
                </nav>

                <div class="px-4 mb-2 text-[10px] font-bold text-slate-500 uppercase">系统设置</div>
                <nav class="space-y-1">
                    <a class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition">
                        <i class="fa-solid fa-users-gear w-5"></i> <span>用户与角色</span>
                    </a>
                    <a class="nav-item cursor-pointer flex items-center px-6 py-3 hover:bg-slate-800 hover:text-white transition">
                        <i class="fa-solid fa-sliders w-5"></i> <span>全局配置</span>
                    </a>
                </nav>
            </div>

            <div class="p-4 border-t border-slate-800">
                <div class="flex items-center gap-3">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=0F172A&color=fff&border=true" class="w-9 h-9 rounded-full border border-slate-600">
                    <div>
                        <div class="text-white font-medium text-sm">System Admin</div>
                        <div class="text-xs text-green-500 flex items-center gap-1"><i class="fa-solid fa-circle text-[8px]"></i> Online</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- CONTENT -->
        <main class="flex-1 flex flex-col bg-slate-50 min-w-0">
            <!-- Header -->
            <header class="h-16 bg-white border-b border-slate-200 flex justify-between items-center px-8 shadow-sm z-20">
                <h2 class="text-lg font-bold text-slate-700" id="page-title">仪表盘</h2>
                
                <div class="flex items-center gap-6">
                    <!-- Search -->
                    <div class="relative hidden md:block">
                        <input type="text" placeholder="搜索用户、日志、文件..." class="pl-9 pr-4 py-1.5 w-64 border border-slate-200 rounded-full bg-slate-50 focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none text-sm transition">
                        <i class="fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-slate-400 text-xs"></i>
                    </div>

                    <!-- Notification Dropdown (Functional) -->
                    <div class="relative" id="notification-wrapper">
                        <button onclick="toggleNotifications()" class="relative p-2 text-slate-500 hover:text-blue-600 transition outline-none">
                            <i class="fa-regular fa-bell text-xl"></i>
                            <span class="absolute top-1.5 right-1.5 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-white animate-pulse"></span>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="notification-dropdown" class="absolute right-0 top-12 w-80 bg-white rounded-xl shadow-xl border border-slate-100 hidden animate-slide-down origin-top-right z-50 overflow-hidden">
                            <div class="p-3 border-b border-slate-50 bg-slate-50 flex justify-between items-center">
                                <span class="font-bold text-slate-700">通知 (4)</span>
                                <button class="text-xs text-blue-600 hover:underline">全部已读</button>
                            </div>
                            <div class="max-h-80 overflow-y-auto">
                                <div onclick="router('approval')" class="p-3 hover:bg-slate-50 cursor-pointer border-b border-slate-50 flex gap-3 transition">
                                    <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center shrink-0"><i class="fa-solid fa-user-plus text-xs"></i></div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-800">新用户注册申请</p>
                                        <p class="text-xs text-slate-500">员工“王小明”申请加入市场部</p>
                                        <p class="text-[10px] text-slate-400 mt-1">10分钟前</p>
                                    </div>
                                </div>
                                <div onclick="router('audit')" class="p-3 hover:bg-slate-50 cursor-pointer border-b border-slate-50 flex gap-3 transition">
                                    <div class="w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center shrink-0"><i class="fa-solid fa-triangle-exclamation text-xs"></i></div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-800">异常下载警告</p>
                                        <p class="text-xs text-slate-500">IP 192.168.1.55 频繁下载敏感文档</p>
                                        <p class="text-[10px] text-slate-400 mt-1">30分钟前</p>
                                    </div>
                                </div>
                                <div class="p-3 hover:bg-slate-50 cursor-pointer flex gap-3 transition">
                                    <div class="w-8 h-8 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center shrink-0"><i class="fa-solid fa-server text-xs"></i></div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-800">存储空间告警</p>
                                        <p class="text-xs text-slate-500">项目文档盘空间已使用 85%</p>
                                    </div>
                                </div>
                            </div>
                            <div class="p-2 border-t border-slate-100 text-center">
                                <button class="text-xs text-slate-500 hover:text-slate-800">查看历史通知</button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Scrollable View Container -->
            <div class="flex-1 overflow-auto p-8 relative" onclick="closeDropdowns()">
                
                <!-- ================= VIEW 1: DASHBOARD ================= -->
                <div id="view-dashboard" class="page-view animate-fade-in space-y-6">
                    <!-- Key Metrics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-start">
                                <div class="text-slate-500 text-xs font-bold uppercase">系统总文件数</div>
                                <div class="bg-blue-50 text-blue-600 p-2 rounded-lg"><i class="fa-solid fa-database"></i></div>
                            </div>
                            <div class="text-3xl font-bold text-slate-800 mt-2">12,450</div>
                            <div class="text-xs text-green-500 mt-2 font-medium"><i class="fa-solid fa-arrow-trend-up"></i> +125 本周</div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-start">
                                <div class="text-slate-500 text-xs font-bold uppercase">待办审批</div>
                                <div class="bg-orange-50 text-orange-600 p-2 rounded-lg"><i class="fa-solid fa-gavel"></i></div>
                            </div>
                            <div class="text-3xl font-bold text-slate-800 mt-2">4</div>
                            <div class="text-xs text-slate-400 mt-2">含 1 个加急注册申请</div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-start">
                                <div class="text-slate-500 text-xs font-bold uppercase">活跃项目库</div>
                                <div class="bg-purple-50 text-purple-600 p-2 rounded-lg"><i class="fa-solid fa-diagram-project"></i></div>
                            </div>
                            <div class="text-3xl font-bold text-slate-800 mt-2">8</div>
                            <div class="text-xs text-slate-400 mt-2">共 42 位活跃协作者</div>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-start">
                                <div class="text-slate-500 text-xs font-bold uppercase">今日下载量</div>
                                <div class="bg-green-50 text-green-600 p-2 rounded-lg"><i class="fa-solid fa-cloud-arrow-down"></i></div>
                            </div>
                            <div class="text-3xl font-bold text-slate-800 mt-2">189</div>
                            <div class="text-xs text-red-500 mt-2 font-medium"><i class="fa-solid fa-arrow-trend-up"></i> 异常峰值检测</div>
                        </div>
                    </div>

                    <!-- Charts & Logs -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Chart -->
                        <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="font-bold text-slate-800">近7天文件访问/下载趋势</h3>
                                <select class="text-xs border border-slate-200 rounded px-2 py-1 bg-slate-50">
                                    <option>所有部门</option>
                                    <option>市场部</option>
                                    <option>技术部</option>
                                </select>
                            </div>
                            <div class="h-64">
                                <canvas id="dashboardChart"></canvas>
                            </div>
                        </div>

                        <!-- System Health -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col">
                            <h3 class="font-bold text-slate-800 mb-4">系统健康状态</h3>
                            <div class="space-y-6 flex-1">
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="text-slate-600">存储空间 (SSD)</span>
                                        <span class="font-bold text-slate-800">85%</span>
                                    </div>
                                    <div class="w-full bg-slate-100 rounded-full h-2">
                                        <div class="bg-orange-500 h-2 rounded-full" style="width: 85%"></div>
                                    </div>
                                    <p class="text-[10px] text-orange-500 mt-1">建议扩容或清理过期归档</p>
                                </div>
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="text-slate-600">API 响应时间</span>
                                        <span class="font-bold text-emerald-600">45ms</span>
                                    </div>
                                    <div class="w-full bg-slate-100 rounded-full h-2">
                                        <div class="bg-emerald-500 h-2 rounded-full" style="width: 20%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="text-slate-600">备份状态</span>
                                        <span class="font-bold text-blue-600">正常</span>
                                    </div>
                                    <p class="text-xs text-slate-400 mt-1"><i class="fa-regular fa-clock"></i> 上次备份: 今天 02:00 AM</p>
                                </div>
                            </div>
                            <button class="w-full mt-4 py-2 border border-slate-200 rounded-lg text-xs font-medium hover:bg-slate-50">查看服务器监控详情</button>
                        </div>
                    </div>
                </div>

                <!-- ================= VIEW 2: AUDIT LOGS (Enterprise Feature) ================= -->
                <div id="view-audit" class="page-view hidden animate-fade-in flex flex-col h-full">
                    <div class="flex justify-between items-end mb-6">
                        <div>
                            <h2 class="text-xl font-bold text-slate-800">安全审计日志</h2>
                            <p class="text-slate-500 text-xs mt-1">追踪所有用户的文件访问、下载及系统操作行为</p>
                        </div>
                        <div class="flex gap-2">
                            <button class="px-3 py-1.5 bg-white border border-slate-300 rounded text-slate-600 text-xs hover:bg-slate-50"><i class="fa-solid fa-filter mr-1"></i> 高级筛选</button>
                            <button class="px-3 py-1.5 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 shadow-sm"><i class="fa-solid fa-download mr-1"></i> 导出报表</button>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200 mb-4 grid grid-cols-5 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-500 mb-1">时间范围</label>
                            <select class="w-full text-sm border-slate-200 rounded p-1.5 bg-slate-50"><option>最近 24 小时</option><option>最近 7 天</option></select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-500 mb-1">操作类型</label>
                            <select class="w-full text-sm border-slate-200 rounded p-1.5 bg-slate-50"><option>全部</option><option>文件下载</option><option>登录尝试</option></select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-500 mb-1">用户/工号</label>
                            <input type="text" placeholder="输入姓名..." class="w-full text-sm border-slate-200 rounded p-1.5 bg-slate-50">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-500 mb-1">风险等级</label>
                            <select class="w-full text-sm border-slate-200 rounded p-1.5 bg-slate-50"><option>全部</option><option class="text-red-600">高风险</option></select>
                        </div>
                        <div class="flex items-end">
                            <button class="w-full bg-slate-800 text-white py-1.5 rounded text-sm hover:bg-slate-700">查询</button>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden flex-1">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-slate-50 text-xs font-semibold text-slate-500 uppercase tracking-wider">
                                <tr>
                                    <th class="p-4 border-b">时间戳</th>
                                    <th class="p-4 border-b">操作人</th>
                                    <th class="p-4 border-b">IP 地址</th>
                                    <th class="p-4 border-b">操作类型</th>
                                    <th class="p-4 border-b">对象详情</th>
                                    <th class="p-4 border-b">结果</th>
                                    <th class="p-4 border-b text-right">详情</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm divide-y divide-slate-100">
                                <tr class="hover:bg-slate-50">
                                    <td class="p-4 text-slate-500 font-mono text-xs">2026-02-03 14:22:10</td>
                                    <td class="p-4"><div class="font-medium text-slate-800">李杏莉</div><div class="text-xs text-slate-400">市场部</div></td>
                                    <td class="p-4 text-slate-500">192.168.10.45</td>
                                    <td class="p-4"><span class="bg-blue-50 text-blue-600 px-2 py-1 rounded text-xs font-bold">文件下载</span></td>
                                    <td class="p-4 text-slate-600 truncate max-w-xs" title="2026年度财务审计报告_绝密.pdf">2026年度财务审计报告_绝密.pdf</td>
                                    <td class="p-4"><span class="text-green-600 flex items-center gap-1"><i class="fa-solid fa-check"></i> 成功</span></td>
                                    <td class="p-4 text-right"><button class="text-blue-600 hover:underline">查看</button></td>
                                </tr>
                                <tr class="bg-red-50/30 hover:bg-red-50/50">
                                    <td class="p-4 text-slate-500 font-mono text-xs">2026-02-03 14:15:00</td>
                                    <td class="p-4"><div class="font-medium text-slate-800">Unknown</div><div class="text-xs text-slate-400">Guest</div></td>
                                    <td class="p-4 text-slate-500">202.106.0.1</td>
                                    <td class="p-4"><span class="bg-red-50 text-red-600 px-2 py-1 rounded text-xs font-bold">登录失败</span></td>
                                    <td class="p-4 text-slate-600">尝试登录 Admin 账号</td>
                                    <td class="p-4"><span class="text-red-600 flex items-center gap-1"><i class="fa-solid fa-ban"></i> 阻断</span></td>
                                    <td class="p-4 text-right"><button class="text-blue-600 hover:underline">追踪</button></td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="p-4 text-slate-500 font-mono text-xs">2026-02-03 13:40:22</td>
                                    <td class="p-4"><div class="font-medium text-slate-800">张萌萌</div><div class="text-xs text-slate-400">质量部</div></td>
                                    <td class="p-4 text-slate-500">192.168.10.22</td>
                                    <td class="p-4"><span class="bg-purple-50 text-purple-600 px-2 py-1 rounded text-xs font-bold">上传文件</span></td>
                                    <td class="p-4 text-slate-600">ISO9001证书更新.pdf</td>
                                    <td class="p-4"><span class="text-orange-500 flex items-center gap-1"><i class="fa-regular fa-clock"></i> 待审</span></td>
                                    <td class="p-4 text-right"><button class="text-blue-600 hover:underline">查看</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ================= VIEW 3: APPROVAL CENTER (Enhanced) ================= -->
                <div id="view-approval" class="page-view hidden animate-fade-in flex flex-col h-full">
                    <h2 class="text-xl font-bold text-slate-800 mb-6">综合审批中心</h2>
                    
                    <!-- Tabs -->
                    <div class="flex border-b border-slate-200 mb-6">
                        <button onclick="switchTab('tab-users')" id="btn-tab-users" class="px-6 py-3 text-sm font-medium border-b-2 border-blue-600 text-blue-600 bg-blue-50/50 transition">新用户注册 (1)</button>
                        <button onclick="switchTab('tab-files')" id="btn-tab-files" class="px-6 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700 transition">文件发布/下载 (3)</button>
                    </div>

                    <!-- TAB CONTENT: Users -->
                    <div id="tab-users" class="tab-content flex-1">
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex items-start gap-6 animate-fade-in">
                            <div class="w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center text-slate-400 text-3xl shrink-0">
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex justify-between">
                                    <h3 class="text-lg font-bold text-slate-800">申请人：王小明 <span class="text-xs font-normal bg-orange-100 text-orange-600 px-2 py-0.5 rounded ml-2">待审核</span></h3>
                                    <span class="text-xs text-slate-400">申请时间：2026-02-03 10:30</span>
                                </div>
                                <div class="grid grid-cols-3 gap-4 mt-4 text-sm">
                                    <div><span class="text-slate-500 block text-xs mb-1">工号</span><span class="font-medium">EMP2026099</span></div>
                                    <div><span class="text-slate-500 block text-xs mb-1">申请部门</span><span class="font-medium">市场营销部</span></div>
                                    <div><span class="text-slate-500 block text-xs mb-1">职位</span><span class="font-medium">销售助理</span></div>
                                    <div><span class="text-slate-500 block text-xs mb-1">直属领导</span><span class="font-medium">李经理</span></div>
                                    <div class="col-span-2"><span class="text-slate-500 block text-xs mb-1">申请理由</span><span class="bg-slate-50 px-2 py-1 rounded block text-slate-600">入职办理账号，需访问投标资质库进行标书制作。</span></div>
                                </div>
                                <div class="flex gap-3 mt-6">
                                    <button class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm font-medium shadow-sm" onclick="showToast('已批准用户注册，账号已激活', 'success'); this.parentElement.parentElement.parentElement.remove()"><i class="fa-solid fa-check mr-2"></i>批准注册</button>
                                    <button class="px-4 py-2 bg-white border border-red-200 text-red-600 rounded hover:bg-red-50 text-sm font-medium">驳回</button>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-10 text-slate-400 text-sm">
                            没有更多待审核的用户请求了
                        </div>
                    </div>

                    <!-- TAB CONTENT: Files -->
                    <div id="tab-files" class="tab-content hidden h-full flex flex-row gap-6 animate-fade-in">
                        <!-- Left List -->
                        <div class="w-1/3 bg-white border border-slate-200 rounded-lg overflow-y-auto">
                            <div class="p-3 border-b border-slate-100 bg-blue-50 border-l-4 border-l-blue-600 cursor-pointer">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-xs font-bold text-blue-600 bg-blue-100 px-1.5 py-0.5 rounded">上传申请</span>
                                    <span class="text-[10px] text-slate-400">今天</span>
                                </div>
                                <h4 class="font-bold text-slate-800 text-sm">ISO14001环境体系证书.pdf</h4>
                                <p class="text-xs text-slate-500 mt-1">申请人: 张萌萌</p>
                            </div>
                            <div class="p-3 border-b border-slate-100 hover:bg-slate-50 cursor-pointer">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-xs font-bold text-red-600 bg-red-100 px-1.5 py-0.5 rounded">特殊下载</span>
                                    <span class="text-[10px] text-slate-400">昨天</span>
                                </div>
                                <h4 class="font-bold text-slate-800 text-sm">公司股权结构图_机密.jpg</h4>
                                <p class="text-xs text-slate-500 mt-1">申请人: 李四 (企管部)</p>
                            </div>
                        </div>
                        <!-- Right Detail -->
                        <div class="flex-1 bg-white border border-slate-200 rounded-lg p-6 flex flex-col">
                            <h3 class="font-bold text-lg text-slate-800 mb-4">详情审核</h3>
                            <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-4">
                                <div class="grid grid-cols-2 gap-4 text-sm">
                                    <div><label class="text-xs text-slate-400">文件名</label><div class="font-medium">ISO14001环境体系证书.pdf</div></div>
                                    <div><label class="text-xs text-slate-400">文件大小</label><div class="font-medium">2.4 MB</div></div>
                                    <div><label class="text-xs text-slate-400">失效日期</label><div class="font-medium text-emerald-600">2029-01-01</div></div>
                                    <div><label class="text-xs text-slate-400">资质分类</label><div class="font-medium">体系资质 - 环境</div></div>
                                </div>
                            </div>
                            <div class="flex-1 bg-slate-100 border-2 border-dashed border-slate-300 rounded flex items-center justify-center flex-col text-slate-400">
                                <i class="fa-regular fa-file-pdf text-4xl mb-2"></i>
                                <span>文件预览区域</span>
                                <button class="text-xs text-blue-600 hover:underline mt-2">下载源文件</button>
                            </div>
                            <div class="flex justify-end gap-3 mt-4 pt-4 border-t border-slate-100">
                                <button class="px-4 py-2 border border-slate-300 rounded text-slate-600 text-sm hover:bg-slate-50">驳回修改</button>
                                <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm shadow-sm" onclick="showToast('审批通过，文件已发布', 'success')">通过并发布</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ================= VIEW 4: PROJECTS (Enhanced) ================= -->
                <div id="view-projects" class="page-view hidden animate-fade-in">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-slate-800">项目文档管理</h2>
                        <button class="bg-slate-800 text-white px-4 py-2 rounded text-sm hover:bg-slate-700"><i class="fa-solid fa-plus mr-2"></i> 新建项目空间</button>
                    </div>

                    <!-- Project Table -->
                    <div class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden">
                        <table class="w-full text-left">
                            <thead class="bg-slate-50 text-xs text-slate-500 uppercase font-semibold">
                                <tr>
                                    <th class="p-4 border-b">项目名称</th>
                                    <th class="p-4 border-b">负责人</th>
                                    <th class="p-4 border-b">空间占用</th>
                                    <th class="p-4 border-b">权限模式</th>
                                    <th class="p-4 border-b">状态</th>
                                    <th class="p-4 border-b text-right">管理</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm divide-y divide-slate-100">
                                <tr class="hover:bg-slate-50 group">
                                    <td class="p-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-8 h-8 rounded bg-indigo-100 text-indigo-600 flex items-center justify-center"><i class="fa-solid fa-wind"></i></div>
                                            <span class="font-bold text-slate-700">越南风电场投标</span>
                                        </div>
                                    </td>
                                    <td class="p-4 text-slate-600">王江艳 (市场部)</td>
                                    <td class="p-4">
                                        <div class="flex items-center gap-2">
                                            <div class="w-16 h-1.5 bg-slate-200 rounded-full overflow-hidden"><div class="bg-indigo-500 h-full w-[45%]"></div></div>
                                            <span class="text-xs text-slate-500">450MB</span>
                                        </div>
                                    </td>
                                    <td class="p-4"><span class="bg-slate-100 text-slate-600 px-2 py-0.5 rounded text-xs border border-slate-200">受邀成员可见</span></td>
                                    <td class="p-4"><span class="flex items-center gap-1 text-green-600 text-xs font-bold"><i class="fa-solid fa-circle text-[8px]"></i> 进行中</span></td>
                                    <td class="p-4 text-right">
                                        <button class="text-slate-400 hover:text-blue-600 px-2" title="配置权限" onclick="openModal('project-settings')"><i class="fa-solid fa-gear"></i></button>
                                        <button class="text-slate-400 hover:text-slate-800 px-2" title="查看文件"><i class="fa-regular fa-folder-open"></i></button>
                                    </td>
                                </tr>
                                <tr class="hover:bg-slate-50 group">
                                    <td class="p-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-8 h-8 rounded bg-slate-100 text-slate-600 flex items-center justify-center"><i class="fa-solid fa-industry"></i></div>
                                            <span class="font-bold text-slate-700">2026设备采购框架协议</span>
                                        </div>
                                    </td>
                                    <td class="p-4 text-slate-600">李杏莉 (市场部)</td>
                                    <td class="p-4">
                                        <div class="flex items-center gap-2">
                                            <div class="w-16 h-1.5 bg-slate-200 rounded-full overflow-hidden"><div class="bg-green-500 h-full w-[80%]"></div></div>
                                            <span class="text-xs text-slate-500">800MB</span>
                                        </div>
                                    </td>
                                    <td class="p-4"><span class="bg-slate-100 text-slate-600 px-2 py-0.5 rounded text-xs border border-slate-200">私有</span></td>
                                    <td class="p-4"><span class="flex items-center gap-1 text-slate-400 text-xs font-bold"><i class="fa-solid fa-circle text-[8px]"></i> 已归档</span></td>
                                    <td class="p-4 text-right">
                                        <button class="text-slate-400 hover:text-blue-600 px-2"><i class="fa-solid fa-gear"></i></button>
                                        <button class="text-slate-400 hover:text-slate-800 px-2"><i class="fa-regular fa-folder-open"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                 <!-- ================= VIEW 5: LIBRARY (Admin) ================= -->
                 <div id="view-library" class="page-view hidden animate-fade-in text-center py-20">
                    <div class="bg-white p-10 inline-block rounded-xl shadow-sm border border-slate-200">
                        <i class="fa-solid fa-layer-group text-6xl text-slate-200 mb-4"></i>
                        <h3 class="text-xl font-bold text-slate-800">资质库管理视图</h3>
                        <p class="text-slate-500 mt-2">（此处复用标准视图，增加“强制删除”和“元数据批量编辑”功能）</p>
                    </div>
                 </div>

            </div>
        </main>
    </div>

    <!-- MODAL: Project Settings -->
    <div id="modal-project-settings" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity opacity-0 modal-backdrop" onclick="closeModal('project-settings')"></div>
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <div class="bg-white w-[600px] rounded-xl shadow-2xl pointer-events-auto transform scale-95 opacity-0 transition-all modal-panel flex flex-col max-h-[85vh]">
                <div class="p-5 border-b border-slate-100 flex justify-between items-center">
                    <h3 class="font-bold text-lg text-slate-800">项目设置：越南风电场投标</h3>
                    <button onclick="closeModal('project-settings')" class="text-slate-400 hover:text-slate-600"><i class="fa-solid fa-xmark text-xl"></i></button>
                </div>
                <div class="p-6 overflow-y-auto space-y-6">
                    <div>
                        <h4 class="text-xs font-bold text-slate-500 uppercase mb-3">成员权限</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-2 bg-slate-50 rounded border border-slate-200">
                                <div class="flex items-center gap-3">
                                    <img src="https://ui-avatars.com/api/?name=Wang&background=random" class="w-8 h-8 rounded-full">
                                    <div class="text-sm">
                                        <div class="font-medium text-slate-800">王江艳</div>
                                        <div class="text-xs text-slate-500">负责人 (Owner)</div>
                                    </div>
                                </div>
                                <span class="text-xs bg-slate-200 text-slate-600 px-2 py-1 rounded">完全控制</span>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-white rounded border border-slate-200">
                                <div class="flex items-center gap-3">
                                    <img src="https://ui-avatars.com/api/?name=Chen&background=random" class="w-8 h-8 rounded-full">
                                    <div class="text-sm">
                                        <div class="font-medium text-slate-800">陈佩莹</div>
                                        <div class="text-xs text-slate-500">技术部</div>
                                    </div>
                                </div>
                                <select class="text-xs border border-slate-300 rounded px-2 py-1 bg-white">
                                    <option>仅上传</option>
                                    <option selected>读写</option>
                                </select>
                            </div>
                            <button class="text-xs text-blue-600 hover:underline pl-1">+ 添加新成员</button>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-xs font-bold text-slate-500 uppercase mb-3">存储配额</h4>
                        <div class="flex items-center gap-4">
                            <input type="range" class="flex-1 h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600" value="45">
                            <span class="text-sm font-medium text-slate-700 w-20 text-right">2 GB</span>
                        </div>
                    </div>
                </div>
                <div class="p-5 border-t border-slate-100 bg-slate-50 flex justify-end gap-3 rounded-b-xl">
                    <button onclick="closeModal('project-settings')" class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-white">取消</button>
                    <button onclick="closeModal('project-settings'); showToast('项目设置已更新', 'success')" class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 shadow-sm">保存更改</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Router Logic ---
        function router(pageId) {
            // Hide all views
            document.querySelectorAll('.page-view').forEach(el => el.classList.add('hidden'));
            
            // Show target
            const target = document.getElementById(`view-${pageId}`);
            if (target) {
                target.classList.remove('hidden');
                
                // If opening audit, init chart
                if (pageId === 'dashboard') {
                    initChart();
                }
            }

            // Update Page Title
            const titles = {
                'dashboard': '系统仪表盘',
                'audit': '安全审计日志',
                'approval': '综合审批中心',
                'projects': '项目管理控制台',
                'library': '资质库管理'
            };
            document.getElementById('page-title').innerText = titles[pageId] || 'TenderVault';

            // Sidebar active state
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active', 'bg-slate-800', 'text-white'));
            const activeNav = document.getElementById(`nav-${pageId}`);
            if(activeNav) activeNav.classList.add('active');
        }

        // --- Notification Logic ---
        function toggleNotifications() {
            const dropdown = document.getElementById('notification-dropdown');
            dropdown.classList.toggle('hidden');
        }

        function closeDropdowns() {
            document.getElementById('notification-dropdown').classList.add('hidden');
        }

        // --- Tab Logic ---
        function switchTab(tabId) {
            // Hide contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            // Show target
            document.getElementById(tabId).classList.remove('hidden');

            // Update buttons
            document.getElementById('btn-tab-users').classList.remove('border-blue-600', 'text-blue-600', 'bg-blue-50/50');
            document.getElementById('btn-tab-files').classList.remove('border-blue-600', 'text-blue-600', 'bg-blue-50/50');
            document.getElementById('btn-tab-users').classList.add('text-slate-500', 'border-transparent');
            document.getElementById('btn-tab-files').classList.add('text-slate-500', 'border-transparent');

            const activeBtn = document.getElementById(`btn-${tabId}`);
            activeBtn.classList.remove('text-slate-500', 'border-transparent');
            activeBtn.classList.add('border-blue-600', 'text-blue-600', 'bg-blue-50/50');
        }

        // --- Modal Logic ---
        function openModal(id) {
            const modal = document.getElementById(`modal-${id}`);
            modal.classList.remove('hidden');
            // Trigger animation
            setTimeout(() => {
                modal.querySelector('.modal-backdrop').classList.remove('opacity-0');
                modal.querySelector('.modal-panel').classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        function closeModal(id) {
            const modal = document.getElementById(`modal-${id}`);
            modal.querySelector('.modal-backdrop').classList.add('opacity-0');
            modal.querySelector('.modal-panel').classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 250);
        }

        // --- Toast Logic ---
        function showToast(msg, type='info') {
            const container = document.getElementById('toast-container');
            const el = document.createElement('div');
            const colors = type === 'success' ? 'bg-emerald-600' : 'bg-slate-800';
            const icon = type === 'success' ? '<i class="fa-solid fa-check mr-2"></i>' : '<i class="fa-solid fa-info-circle mr-2"></i>';
            
            el.className = `${colors} text-white px-4 py-3 rounded shadow-lg text-sm flex items-center transform transition-all translate-x-full duration-300`;
            el.innerHTML = `${icon} ${msg}`;
            container.appendChild(el);

            // Animate in
            requestAnimationFrame(() => el.classList.remove('translate-x-full'));

            // Remove
            setTimeout(() => {
                el.classList.add('opacity-0', 'translate-x-full');
                setTimeout(() => el.remove(), 300);
            }, 3000);
        }

        // --- Chart.js Logic ---
        let chartInstance = null;
        function initChart() {
            const ctx = document.getElementById('dashboardChart');
            if (!ctx) return;
            
            if (chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: '下载量',
                        data: [65, 59, 80, 81, 56, 55, 40],
                        borderColor: '#2563EB',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: '上传量',
                        data: [28, 48, 40, 19, 86, 27, 90],
                        borderColor: '#10B981',
                        borderDash: [5, 5],
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', align: 'end', labels: { boxWidth: 10, usePointStyle: true } }
                    },
                    scales: {
                        y: { beginAtZero: true, grid: { borderDash: [2, 4], color: '#f1f5f9' } },
                        x: { grid: { display: false } }
                    }
                }
            });
        }

        // Init
        window.onload = function() {
            router('dashboard');
        }
    </script>
</body>
</html>